http://pastie.org/439436
http://github.com/stffn/declarative_authorization/tree/master
